{% extends "layouts/base_layout.html" %}

{% block title %}Load Profile Analysis - KSEB Energy Futures{% endblock %}

{% block content %}
<div class="module-container">
    <h2>Load Profile Generation: Analysis & Visualization</h2>
    <p>Analyze generated load profiles, view statistics, and compare different profiles.</p>

    <div class="profile-info-bar">
        <div><strong>Profile Name:</strong> <span id="lp-info-name">Baseline_Hourly_2025-2030_MW</span></div>
        <div><strong>Generated:</strong> <span id="lp-info-date">2024-08-05 10:30 AM</span></div>
        <div><strong>Frequency:</strong> <span id="lp-info-freq">Hourly</span></div>
        <div><strong>Size:</strong> <span id="lp-info-size">Approx. 52,560 records</span></div>
        <div><strong>Status:</strong> <span id="lp-info-status" class="status-ok">Ready for Analysis</span></div>
    </div>

    <div class="content-grid-lp-analysis">
        <section class="chart-section-lp main-chart-lp">
            <h3>Annual Load Profile Heatmap / Timeseries</h3>
            <div id="annual-load-profile-heatmap" class="chart-placeholder-large">
                <p>Annual load profile heatmap or timeseries chart will appear here.</p>
            </div>
        </section>

        <aside class="controls-stats-lp">
            <div class="analysis-controls">
                <h4>Analysis Controls</h4>
                <div class="form-group">
                    <label for="lp-analysis-year">Select Year:</label>
                    <select id="lp-analysis-year" name="analysisYear">
                        <option value="2025" selected>2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                        <option value="2028">2028</option>
                        <option value="2029">2029</option>
                        <option value="2030">2030</option>
                        <option value="all">All Years (Aggregated)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="lp-analysis-view">View Type:</label>
                    <select id="lp-analysis-view" name="analysisView">
                        <option value="heatmap" selected>Heatmap (Hourly)</option>
                        <option value="avg_daily">Average Daily Profile</option>
                        <option value="monthly_peak">Monthly Peaks</option>
                    </select>
                </div>
                 <div class="form-group">
                    <label for="lp-analysis-metric">Metric:</label>
                    <select id="lp-analysis-metric" name="analysisMetric">
                        <option value="load_mw" selected>Load (MW)</option>
                        <option value="load_factor">Load Factor (%)</option>
                    </select>
                </div>
                <button id="lp-apply-analysis-filters" class="btn-secondary full-width-btn">Apply Filters</button>
            </div>

            <div class="statistical-summary">
                <h4>Statistical Summary (<span id="summary-year">2025</span>)</h4>
                <ul>
                    <li><strong>Peak Load:</strong> <span id="stat-peak-load">4500 MW</span> (on Aug 15, 18:00)</li>
                    <li><strong>Base Load:</strong> <span id="stat-base-load">1800 MW</span></li>
                    <li><strong>Total Energy:</strong> <span id="stat-total-energy">25,000 GWh</span></li>
                    <li><strong>Annual Load Factor:</strong> <span id="stat-load-factor">65%</span></li>
                    <li><strong>Std. Deviation:</strong> <span id="stat-std-dev">800 MW</span></li>
                </ul>
            </div>
        </aside>

        <section class="chart-section-lp">
            <h3>Daily Patterns (Average Weekday/Weekend)</h3>
            <div id="daily-patterns-chart" class="chart-placeholder-medium">
                <p>Average daily load patterns chart will appear here.</p>
            </div>
        </section>

        <section class="chart-section-lp">
            <h3>Load Duration Curve</h3>
            <div id="load-duration-curve-chart" class="chart-placeholder-medium">
                <p>Load duration curve chart will appear here.</p>
            </div>
        </section>
    </div>

    <div class="form-actions bottom-actions">
        <button type="button" id="lp-export-analysis-btn" class="btn-secondary">Export Analysis Data</button>
        <button type="button" id="lp-compare-profiles-btn" class="btn-secondary">Compare Profiles</button>
        <button type="button" id="lp-use-in-pypsa-btn" class="btn-primary">Use Profile in PyPSA Model</button>
    </div>
</div>
{% endblock %}
